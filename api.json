{
  "api_documentation": {
    "version": "1.0.0",
    "title": "NexusGaming Backend API",
    "description": "遊戲管理後台系統 API 文檔",
    "base_url": "http://localhost:8080",
    "last_updated": "2024-12-19",
    "endpoints": {
      "authentication": {
        "login": {
          "method": "POST",
          "path": "/api/v1/auth/login",
          "description": "使用者登入",
          "content_type": "application/json",
          "auth_required": false,
          "request_body": {
            "username": {
              "type": "string",
              "required": true,
              "description": "使用者名稱",
              "example": "admin"
            },
            "password": {
              "type": "string",
              "required": true,
              "description": "密碼",
              "example": "password123"
            }
          },
          "responses": {
            "200": {
              "description": "登入成功",
              "content": {
                "success": true,
                "message": "登入成功",
                "data": {
                  "token": "JWT Token 字串",
                  "user": "使用者資訊物件",
                  "expires_in": 86400,
                  "token_type": "Bearer"
                }
              }
            },
            "400": {
              "description": "請求參數錯誤"
            },
            "401": {
              "description": "帳號或密碼錯誤"
            },
            "500": {
              "description": "伺服器內部錯誤"
            }
          }
        },
        "logout": {
          "method": "POST",
          "path": "/api/v1/auth/logout",
          "description": "使用者登出",
          "content_type": "application/json",
          "auth_required": true,
          "auth_header": "Authorization: Bearer {token}",
          "request_body": {
            "token": {
              "type": "string",
              "required": false,
              "description": "JWT Token（可從 Header 或 Body 提供）",
              "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            }
          },
          "responses": {
            "200": {
              "description": "登出成功"
            },
            "400": {
              "description": "請求參數錯誤"
            },
            "401": {
              "description": "Token 無效"
            }
          }
        },
        "refresh": {
          "method": "POST",
          "path": "/api/v1/auth/refresh",
          "description": "刷新 Token",
          "content_type": "application/json",
          "auth_required": false,
          "request_body": {
            "token": {
              "type": "string",
              "required": true,
              "description": "舊的 JWT Token",
              "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            }
          },
          "responses": {
            "200": {
              "description": "刷新成功",
              "content": {
                "success": true,
                "message": "Token 刷新成功",
                "data": {
                  "token": "新的 JWT Token 字串",
                  "expires_in": 86400,
                  "token_type": "Bearer"
                }
              }
            },
            "400": {
              "description": "請求參數錯誤"
            },
            "401": {
              "description": "Token 無效或已過期"
            }
          }
        },
        "profile": {
          "method": "GET",
          "path": "/api/v1/auth/profile",
          "description": "獲取當前使用者資訊",
          "content_type": "application/json",
          "auth_required": true,
          "auth_header": "Authorization: Bearer {token}",
          "request_body": null,
          "responses": {
            "200": {
              "description": "獲取成功",
              "content": {
                "success": true,
                "message": "獲取使用者資訊成功",
                "data": {
                  "id": "使用者 ID",
                  "username": "使用者名稱",
                  "email": "電子郵件",
                  "role_id": "角色 ID",
                  "role": "角色物件",
                  "status": "狀態",
                  "last_login_at": "最後登入時間",
                  "created_at": "建立時間",
                  "updated_at": "更新時間"
                }
              }
            },
            "401": {
              "description": "Token 無效"
            }
          }
        }
      },
      "health": {
        "health_check": {
          "method": "GET",
          "path": "/health",
          "description": "健康檢查",
          "content_type": "application/json",
          "auth_required": false,
          "responses": {
            "200": {
              "description": "服務正常",
              "content": {
                "success": true,
                "message": "Service is healthy",
                "data": {
                  "status": "ok",
                  "timestamp": "2024-12-19T12:00:00Z",
                  "service": "nexus-gaming-backend"
                }
              }
            }
          }
        }
      },
      "players": {
        "get_players": {
          "method": "GET",
          "path": "/api/v1/players",
          "description": "獲取玩家列表（支援分頁、排序、搜尋、篩選）",
          "content_type": "application/json",
          "auth_required": true,
          "auth_header": "Authorization: Bearer {token}",
          "query_parameters": {
            "page": {
              "type": "integer",
              "required": false,
              "default": 1,
              "minimum": 1,
              "description": "頁碼，從1開始",
              "example": 1
            },
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "minimum": 1,
              "maximum": 100,
              "description": "每頁數量，最大100",
              "example": 20
            },
            "sort": {
              "type": "string",
              "required": false,
              "default": "id",
              "enum": ["id", "username", "email", "created_at", "updated_at", "total_bet", "total_win"],
              "description": "排序欄位",
              "example": "created_at"
            },
            "order": {
              "type": "string",
              "required": false,
              "default": "desc",
              "enum": ["asc", "desc"],
              "description": "排序順序",
              "example": "desc"
            },
            "search": {
              "type": "string",
              "required": false,
              "description": "搜尋關鍵字（搜尋使用者名稱、郵件、真實姓名）",
              "example": "john"
            },
            "status": {
              "type": "string",
              "required": false,
              "enum": ["active", "inactive", "suspended", "deleted"],
              "description": "篩選玩家狀態",
              "example": "active"
            },
            "verification_level": {
              "type": "string",
              "required": false,
              "enum": ["none", "email", "phone", "identity"],
              "description": "篩選驗證等級",
              "example": "email"
            },
            "risk_level": {
              "type": "string",
              "required": false,
              "enum": ["low", "medium", "high"],
              "description": "篩選風險等級",
              "example": "low"
            },
            "start_date": {
              "type": "string",
              "required": false,
              "format": "date",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
              "description": "註冊開始日期，格式：YYYY-MM-DD",
              "example": "2024-01-01"
            },
            "end_date": {
              "type": "string",
              "required": false,
              "format": "date",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
              "description": "註冊結束日期，格式：YYYY-MM-DD",
              "example": "2024-12-31"
            },
            "min_balance": {
              "type": "string",
              "required": false,
              "pattern": "^[0-9]+\\.?[0-9]*$",
              "description": "最小餘額篩選",
              "example": "100.00"
            },
            "max_balance": {
              "type": "string",
              "required": false,
              "pattern": "^[0-9]+\\.?[0-9]*$",
              "description": "最大餘額篩選",
              "example": "10000.00"
            }
          },
          "responses": {
            "200": {
              "description": "獲取成功",
              "content": {
                "success": true,
                "message": "獲取玩家列表成功",
                "data": {
                  "players": "玩家資料陣列（包含餘額資訊）",
                  "total": "總玩家數量",
                  "page": "當前頁碼",
                  "limit": "每頁數量",
                  "total_pages": "總頁數",
                  "sort": "排序欄位",
                  "order": "排序順序"
                }
              }
            },
            "400": {
              "description": "請求參數錯誤"
            },
            "401": {
              "description": "未授權"
            },
            "500": {
              "description": "伺服器內部錯誤"
            }
          }
        },
        "get_player": {
          "method": "GET",
          "path": "/api/v1/players/{id}",
          "description": "根據ID獲取玩家詳細資訊，包含基本資料、錢包狀態、標籤、限制和統計",
          "content_type": "application/json",
          "auth_required": true,
          "auth_header": "Authorization: Bearer {token}",
          "path_parameters": {
            "id": {
              "type": "integer",
              "required": true,
              "description": "玩家ID",
              "example": 123
            }
          },
          "responses": {
            "200": {
              "description": "成功取得玩家詳細資訊",
              "content": {
                "success": true,
                "message": "Player details retrieved successfully",
                "data": {
                  "id": 123,
                  "username": "player123",
                  "email": "player@example.com",
                  "real_name": "張三",
                  "phone": "+886912345678",
                  "status": "active",
                  "verification_level": "email",
                  "risk_level": "low",
                  "total_bet": 15000.00,
                  "total_win": 12500.00,
                  "last_login_at": "2024-12-01T10:30:00Z",
                  "created_at": "2024-01-15T08:00:00Z",
                  "updated_at": "2024-12-01T10:30:00Z",
                  "balance": 2500.50,
                  "tags": [
                    {
                      "id": 1,
                      "name": "VIP",
                      "type": "level"
                    }
                  ],
                  "restrictions": [
                    {
                      "id": 1,
                      "restriction_type": "bet_limit",
                      "value": "1000",
                      "is_active": true,
                      "expires_at": "2025-01-01T00:00:00Z"
                    }
                  ],
                  "statistics": {
                    "total_games": 45,
                    "win_rate": 68.9,
                    "average_bet": 333.33,
                    "biggest_win": 2000.00,
                    "biggest_loss": -500.00,
                    "days_registered": 320,
                    "last_activity_days": 1
                  },
                  "recent_games": [
                    {
                      "id": 501,
                      "game_type": "texas_holdem",
                      "bet_amount": 100.00,
                      "win_amount": 200.00,
                      "result": "win",
                      "played_at": "2024-11-30T15:45:00Z"
                    }
                  ]
                }
              }
            },
            "400": {
              "description": "請求參數錯誤",
              "content": {
                "success": false,
                "message": "Invalid player ID format",
                "error_code": "INVALID_PLAYER_ID"
              }
            },
            "401": {
              "description": "未授權",
              "content": {
                "success": false,
                "message": "Unauthorized",
                "error_code": "UNAUTHORIZED"
              }
            },
            "404": {
              "description": "玩家不存在",
              "content": {
                "success": false,
                "message": "Player not found",
                "error_code": "PLAYER_NOT_FOUND"
              }
            },
            "500": {
              "description": "伺服器內部錯誤",
              "content": {
                "success": false,
                "message": "Failed to query player: database connection error",
                "error_code": "DATABASE_ERROR"
              }
            }
          }
        },
        "get_player_game_history": {
          "method": "GET",
          "path": "/api/v1/players/{id}/games",
          "description": "取得特定玩家的遊戲歷史記錄，支援分頁、排序、篩選和統計摘要",
          "content_type": "application/json",
          "auth_required": true,
          "auth_header": "Authorization: Bearer {token}",
          "path_parameters": {
            "id": {
              "type": "integer",
              "required": true,
              "description": "玩家ID",
              "example": 123
            }
          },
          "query_parameters": {
            "page": {
              "type": "integer",
              "required": false,
              "minimum": 1,
              "description": "頁碼（預設1）",
              "example": 1
            },
            "limit": {
              "type": "integer",
              "required": false,
              "minimum": 1,
              "maximum": 100,
              "description": "每頁數量（預設20，最大100）",
              "example": 20
            },
            "sort": {
              "type": "string",
              "required": false,
              "enum": ["played_at", "bet_amount", "win_amount", "result"],
              "description": "排序字段（預設：played_at）",
              "example": "played_at"
            },
            "order": {
              "type": "string",
              "required": false,
              "enum": ["asc", "desc"],
              "description": "排序順序（預設：desc）",
              "example": "desc"
            },
            "game_type": {
              "type": "string",
              "required": false,
              "enum": ["texas_holdem", "stud_poker", "baccarat"],
              "description": "遊戲類型篩選",
              "example": "texas_holdem"
            },
            "result": {
              "type": "string",
              "required": false,
              "enum": ["win", "loss", "draw"],
              "description": "結果篩選",
              "example": "win"
            },
            "start_date": {
              "type": "string",
              "required": false,
              "format": "date",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
              "description": "開始日期，格式：YYYY-MM-DD",
              "example": "2024-01-01"
            },
            "end_date": {
              "type": "string",
              "required": false,
              "format": "date",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
              "description": "結束日期，格式：YYYY-MM-DD",
              "example": "2024-12-31"
            },
            "min_bet": {
              "type": "string",
              "required": false,
              "pattern": "^[0-9]+\\.?[0-9]*$",
              "description": "最小下注金額",
              "example": "10.00"
            },
            "max_bet": {
              "type": "string",
              "required": false,
              "pattern": "^[0-9]+\\.?[0-9]*$",
              "description": "最大下注金額",
              "example": "1000.00"
            }
          },
          "responses": {
            "200": {
              "description": "成功取得玩家遊戲歷史",
              "content": {
                "success": true,
                "message": "Game history retrieved successfully",
                "data": {
                  "games": [
                    {
                      "id": 501,
                      "session_id": 1001,
                      "game_type": "texas_holdem",
                      "game_name": "德州撲克",
                      "bet_amount": 100.00,
                      "win_amount": 200.00,
                      "net_amount": 100.00,
                      "result": "win",
                      "played_at": "2024-11-30T15:45:00Z",
                      "duration": 1200,
                      "game_details": "{\"table_id\": 5, \"position\": \"dealer\"}"
                    }
                  ],
                  "total": 150,
                  "page": 1,
                  "limit": 20,
                  "total_pages": 8,
                  "sort": "played_at",
                  "order": "desc",
                  "summary": {
                    "total_games": 150,
                    "total_bet": 15000.00,
                    "total_win": 12500.00,
                    "net_profit": -2500.00,
                    "win_rate": 68.9,
                    "average_bet": 100.00,
                    "biggest_win": 2000.00,
                    "biggest_loss": -500.00
                  }
                }
              }
            },
            "400": {
              "description": "請求參數錯誤",
              "content": {
                "success": false,
                "message": "Invalid player ID format",
                "error_code": "INVALID_PLAYER_ID"
              }
            },
            "401": {
              "description": "未授權",
              "content": {
                "success": false,
                "message": "Unauthorized",
                "error_code": "UNAUTHORIZED"
              }
            },
            "404": {
              "description": "玩家不存在",
              "content": {
                "success": false,
                "message": "Player not found",
                "error_code": "PLAYER_NOT_FOUND"
              }
            },
            "500": {
              "description": "伺服器內部錯誤",
              "content": {
                "success": false,
                "message": "Failed to query game history: database connection error",
                "error_code": "DATABASE_ERROR"
              }
            }
          }
        }
      }
    },
    "common_responses": {
      "error_format": {
        "success": false,
        "message": "錯誤訊息",
        "data": {
          "error": "詳細錯誤資訊"
        },
        "code": "錯誤代碼（可選）"
      }
    },
    "authentication": {
      "type": "Bearer Token",
      "header": "Authorization: Bearer {jwt_token}",
      "token_expiry": "24 hours",
      "refresh_strategy": "使用 /api/v1/auth/refresh 端點"
    },
    "development_notes": {
      "cors": "已啟用 CORS 中介軟體",
      "logging": "已啟用請求日誌記錄",
      "error_handling": "已啟用全域錯誤處理中介軟體",
      "database": "使用 MySQL 資料庫",
      "password_encryption": "使用 bcrypt 加密"
    }
  }
} 